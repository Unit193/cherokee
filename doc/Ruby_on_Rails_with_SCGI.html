<html>
 <header>
     <title>Cherokee Web Server: Ruby on Rails with SCGI</title>
	<style>	
	body {
		
		width: 760px; 
		margin: auto;
		font-family: 'Trebuchet MS', 'Lucida Grande', Verdana, Arial, Sans-Serif;
		font-size: small;
		padding: 10px;
	}
	
	#header {
		border-bottom: 2px solid #b00;
	}

	#toc {
		border: 
		color: #650;
		background-color: #f0e9b0;
		border: 1px solid #a99d3a;
		font-size: small;
		-moz-border-radius: 4px;
		float: right;
		margin: 4px;
	}

	#toc a {
		color: #650;
	}

	#toctitle {
		color: #fff;
		background-color: #650;
	}
	
	h1 {
		border-bottom: 1px solid #b00;
		float: right;
		border-bottom: 0px;
	}

	h2 {
		border-bottom: 1px solid #b00;
	}

	pre {
		background-color: #000;
		color: #ddd;
		padding: 5px;
	}

	#footer {
		border-top: 1px dotted #ddd;
		color: #666;
		font-size: 90%;
		padding: 10px;
		padding-bottom: 40px;
	}

/* Merge template style */

.messagebox {
   border: 1px solid #aaaaaa;
   background-color: #f9f9f9;
   width: 80%;
   margin: 0 auto 1em auto;
   padding: .2em;
   text-align: justify;
}
.messagebox.merge {
   border: 1px solid #cf9fff;
   background-color: #f5edf5;
   text-align: center;
}
.messagebox.cleanup {
   border: 1px solid #9f9fff;
   background-color: #efefff;
   text-align: center;
}
.messagebox.standard-talk {
   border: 1px solid #c0c090;
   background-color: #f8eaba;
}

	</style>
 </header>
 <body>
     <h1>Ruby on Rails with SCGI</h1>
	<div id="header"><img src="cherokee.png" /></div>
	   <table id='toc' class='toc'><tr><td><div id='toctitle'><h2>Contents</h2></div>
<ul>
<li class='toclevel-1'><a href="#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a>
<ul>
<li class='toclevel-2'><a href="#Ruby_Gems"><span class="tocnumber">1.1</span> <span class="toctext">Ruby Gems</span></a></li>
<li class='toclevel-2'><a href="#Ruby_on_Rails"><span class="tocnumber">1.2</span> <span class="toctext">Ruby on Rails</span></a></li>
<li class='toclevel-2'><a href="#SCGI_for_Ruby_on_Rails"><span class="tocnumber">1.3</span> <span class="toctext">SCGI for Ruby on Rails</span></a></li>
<li class='toclevel-2'><a href="#Example_project"><span class="tocnumber">1.4</span> <span class="toctext">Example project</span></a></li>
<li class='toclevel-2'><a href="#Start_the_SCGI_server"><span class="tocnumber">1.5</span> <span class="toctext">Start the SCGI server</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="#Cherokee_configuration_file"><span class="tocnumber">2</span> <span class="toctext">Cherokee configuration file</span></a></li>
<li class='toclevel-1'><a href="#Test"><span class="tocnumber">3</span> <span class="toctext">Test</span></a></li>
</ul>
</td></tr></table>
<p><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
</p>
<a name="Installation"></a><h2>Installation</h2>
<p>You will need to install Ruby, and RubyGems.  Most of the distributions provide packages for them, but in case your operating systems doesn't provide it here are the links to the web sites:
</p>
<ul><li> <a href="http://www.ruby-lang.org" class='external text' title="http://www.ruby-lang.org" rel="nofollow">Ruby</a>: Ruby language interpreter
</li><li> <a href="http://www.rubygems.org" class='external text' title="http://www.rubygems.org" rel="nofollow">RubyGems</a>: Ruby package installator
</li></ul>
<p><br />
</p>
<a name="Ruby_Gems"></a><h3>Ruby Gems</h3>
<p>Now, we need to fetch the package list:
</p>
<pre># gem update      
Upgrading installed gems...
Gems: [] updated
</pre>
<a name="Ruby_on_Rails"></a><h3>Ruby on Rails</h3>
<p>Now, everything is ready to install Ruby on rails:
</p>
<pre># gem install rails
Attempting local installation of 'rails'
Local gem file not found: rails*.gem
Attempting remote installation of 'rails'
Updating Gem source index for: http://gems.rubyforge.org
Install required dependency rake? [Yn]  
Install required dependency activesupport? [Yn]  
Install required dependency activerecord? [Yn]  
Install required dependency actionpack? [Yn]  
Install required dependency actionmailer? [Yn]  
Install required dependency actionwebservice? [Yn]  
Successfully installed rails-1.0.0
Successfully installed rake-0.7.0
Successfully installed activesupport-1.2.5
Successfully installed activerecord-1.13.2
Successfully installed actionpack-1.11.2
Successfully installed actionmailer-1.1.5
Successfully installed actionwebservice-1.0.0
Installing RDoc documentation for rake-0.7.0...
Installing RDoc documentation for activesupport-1.2.5...
Installing RDoc documentation for activerecord-1.13.2...
Installing RDoc documentation for actionpack-1.11.2...
Installing RDoc documentation for actionmailer-1.1.5...
Installing RDoc documentation for actionwebservice-1.0.0...
</pre>
<a name="SCGI_for_Ruby_on_Rails"></a><h3>SCGI for Ruby on Rails</h3>
<p>Now, it is necesary to install the SCGI interface of Ruby On Rails.  In this case, we will need to download the "gem" file, and compile it:
</p>
<pre># wget http://www.zedshaw.com/downloads/scgi_rails/scgi_rails-0.4.3.gem 
# gem install scgi_rails-0.4.3.gem</pre>
<p>If this step fails, probably is because you need to install the Ruby development package first.
</p>
<a name="Example_project"></a><h3>Example project</h3>
<p>Lets create an example project.  The following example uses <i>/var/www</i> to place the <i>rails</i> directory, but it doesn't matter what directory you use.
</p>
<pre># mkdir /var/www/rails
# cd /var/www/rails
$ $ rails example
      create  
      create  app/controllers
[..]
      create  log/development.log
      create  log/test.log
</pre>
And now, lets create a new control: <pre>ruby script/generate controller MyTest</pre>.  This done, we can add a few lines to build a "Hello World" example.  Edit <i>app/controllers/my_test_controller.rb</i> in order to make it look like this:
<pre>class MyTestController &lt; ApplicationController
   def index
      render_text &quot;Hello World&quot;
   end
end
</pre>
<a name="Start_the_SCGI_server"></a><h3>Start the SCGI server</h3>
<pre>$ cd example
$ scgi_ctrl config
What password do you want?

$ scgi_ctrl start
</pre>
<a name="Cherokee_configuration_file"></a><h2>Cherokee configuration file</h2>
<p>This is a configuration file of one of the approached you can use to run Ruby on Rails in Cherokee:
</p>
<ul><li> It sets the project directory as document root
</li><li> The directory <i>/public</i> will host the static content
</li><li> Everything else will be manager by SCGI, but the special request "/"
</li></ul>
<p><br />
</p>
<pre>Documentroot /var/www/rails/example/
DirectoryIndex index.html

Directory /public {
  Handler file
}

Directory / {
  Handler scgi {
    Server localhost:9999
    ErrorHandler on
  }
}

Request &quot;^/$&quot; {
  Handler redir { Rewrite &quot;&quot; &quot;/public/index.html&quot; }
}
</pre>
<a name="Test"></a><h2>Test</h2>
Finally, the test: <pre>http://localhost/MyTest</pre>

     <div id="footer"><a href="http://www.0x50.org">Cherokee</a> Web Server</div>
 </body>
</html>
